### 缓存雪崩

问题：大量的缓存一下子全部失效了，或者缓存挂了

解决方法：

- 事前：Redis 高可用，主从 + 哨兵，Redis cluster，避免全盘崩溃。另外，key的过期时间不要相同，可以加一个随机数
- 事中：本地 ehcache 缓存 + hystrix 限流 & 降级，避免 MySQL 被打死。
- 事后：Redis 持久化，一旦重启，自动从磁盘上加载数据，快速恢复缓存数据。

### 缓存击穿

问题：大量的请求打过来时，缓存突然失效了，所有请求被打到数据库上了

解决方法：

- 若缓存的数据更新少：可以将缓存设置成永不更新
- 若缓存的更新少且缓存刷新耗时少：设置请求队列，使用分布式互斥锁或本地互斥锁，保证少量请求走数据库，请求数据库结束后重建缓存，然后这些请求一并走缓存
- 若缓存的数据更新频繁或刷新流程长：可以使用定时线程在缓存过期前主动延后缓存的过期时间

### 缓存穿透