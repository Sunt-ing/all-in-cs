### **引言**

时空数据库是管理空间、时态以及移动对象数据的数据库系统，**与传统的关系型数据相比，时空数据具有多维度、多类型、动态变化、更新快等特点，关系型数据库不能很好地处理此类数据**，需要新的有效数据管理方法。近年来，时空数据库在地理信息系统、城市交通管理及分析、计算机图形图像、金融、医疗、基于位置服务等领域有着广泛的应用。根据时空数据特点，时空数据库大致包括以下 3 种.

● 空间数据库：主要处理点、线、区域等二维数据，数据库系统需提供相应的数据类型**以支持数据表示、存储、常见拓扑运算操作和高效查询处理**，同时需要与传统的关系数据库系统融合以扩展数据库系统处理能力，支持不同类型数据的查询处理；

● 时态数据库：管理数据的时间属性，包括**有效时间 (valid time)、事务时间 (transaction time)** 等。时间可以为时间点或者时间区间：如果是时间区间，数据库管理系统将以开始和结束时间两个属性或一个区间属性进行存储。不同的应用场景下，时间属性会有相应的特点 (例如周期性);

● 移动对象数据库：管理位置随时间连续变化的空间对象，主要有移动点和移动区域：前者仅是位置随时间变化，后者还包括形状和面积的变化。移动对象具有**数据量大、位置更新频繁、运算操作复杂**等特点。近年来，随着定位设备的不断普及，例如智能手机，采集这类数据越来越容易。同时，与地图兴趣点 (例如酒店、餐馆等) 相结合，使得移动对象具有语义信息，带来各种新的应用，例如基于位置服务、最优路径规划等.

### 主要研究问题

● 数据模型和查询语言

数据模型包含数据类型和运算操作两个方面。时空数据类型包含多个，有些为定长记录存储 (例如点、区间), 有些为变长记录存储 (例如区域、移动点). 运算操作定义时空拓扑运算 (例如相交 intersect、重合 overlap), 包含语法和语义两个层面：前者描述输入输出参数类型，后者定义抽象层含义。时态和移动对象数据库均处理具有时间因素的对象，数据类型和运算操作都涉及随时间变化的数值，增加了复杂性，主要体现在如何表示数值的动态变化以及拓扑运算定义和求解方法上。移动对象除了要考虑自身的时空属性外，还需要结合对象所在的受限制空间环境，例如道路网、室内空间等，因为位置表示与此相关。此外，不确定性时空数据也是研究内容之一，包括数据模型和查询语言。时空数据类型可作为关系属性嵌套在关系模式下，从而对查询语言 SQL 扩展 (运算操作、谓词), 以得到时空数据查询语言，支持形式化查询描述.

● 索引结构

根据不同时空数据的特点设计访问结构，以支持快速查询处理，常见的空间和时态索引有 **R-tree、K-d Tree、Interval-tree** 等。不同的索引结构有相应的运算操作，包括创建、插入、删除、更新及查询。其中，R-tree 是最为广泛使用的结构，为提高查询效率，需对数据排序 (例如 z-order), 目的是将相似数据存储在邻近结构里，以减少搜索的 I/O 代价。同时，基于该结构的预测模型可以估计查询的 I/O 代价，为进一步优化提供分析的依据。根据时间因素，移动对象索引可分为两类：(ⅰ) 历史数据索引，管理移动对象从开始到结束的所有位置和时间；(ⅱ) 当前数据及预测索引，管理移动对象当前位置和速度并进行预测，提供有效的位置更新策略及数据缓存方法。由于移动对象的位置、时空分布、查询等频繁发生变化，**主存索引及并行技术往往比外存索引更具优势**，自动调优技术对索引的参数动态调整以使性能最优。时空数据索引可以融入语义描述，从而拓展时空数据管理能力，以支持具有语义的时空查询.

● 查询处理及优化

选择查询和最近邻查询是空间和移动对象数据库最常见的两类查询：前者返回在空间 / 时空查询窗口内的对象，后者返回距离查询目标最近的对象。当查询目标是移动对象时，其最近邻对象也动态地发生变化，称为连续最近邻查询；当返回结果的最近邻是查询目标对象时，称为反向最近邻查询。相似性查询定义评价函数，用于计算对象之间的相似度，返回与查询目标最相近的对象；连接查询用于返回两个数据集中所有符合查询谓词条件 (例如相交、重合) 的实体对，例如找出所有长江和黄河途经的城市。与选择查询、最近邻查询相比，连接查询的复杂性更高，相关优化技术有数据划分、索引创建、排序等。时空数据查询还包括聚类查询、模式匹配、距离查询等。将关键字或语义描述与位置相结合，可进行具有语义的 ranking 或 top-*k* 查询，返回对象不仅符合时空约束，而且满足关键字条件，增加了用户对时空对象的全面理解.

● 时空数据管理系统

在定义了抽象模型的基础上，需要有系统实现模型包括数据结构和算法、逻辑设计及实现，同时需要将时空数据模型和关系模型有效融合，从而扩展数据库处理能力。由于时空数据管理系统涉及多种索引结构和查询算法 (例如，基于 R-tree 的深度优先和宽度优先), 因此需对数据库系统的功能、性能及可扩展性等进行全面测试和评估，发现系统性能瓶颈从而进行优化。这主要通过基准测试完成，一般包括数据集 (真实和模拟)、查询集、索引结构及参数设置等，为模拟各种时空数据分布，需要相应的数据产生器及可视化工具.

除上述研究问题外，时空数据库管理还涉及时空数据仓库、时空图数据、时空数据流、基于位置服务 (最优路径规划和交通预测)、轨迹数据压缩、时空数据挖掘和分析等方面.

### 国内外研究现状

#### 空间数据库

依据不同的环境，空间数据库的研究包括自由空间和受限空间 (例如道路网、有障碍空间), 主要区别在于距离函数，受限空间的距离计算依赖于最短路径求解，比自由空间要复杂。相关查询有范围查询、最近邻 (反向最近邻)、Skyline 查询、动态道路网下最短路径查询和路径规划等，索引技术和搜索策略在查询中起到了关键性作用 [[94](http://www.jos.org.cn/html/2019/1/5646.htm#b94)]. 查询过程一般包括过滤和提炼两个阶段：过滤阶段借助于索引和估计值找到一组备选对象，提炼阶段对每个备选对象进行准确值求解。空间数据库查询还包括最大范围求和、容量受限分配等。在基于位置服务的应用中，隐私保护是一个重要的研究内容，已有的工作包括基于位置隐私的攻击及保护方法，如模糊表示、匿名等.

近 10 年来，**空间关键字查询 (spatial keyword search)** 得到了广泛和深入的研究 [[95](http://www.jos.org.cn/html/2019/1/5646.htm#b95)], 通过将空间位置与文本相结合，用户可以查询同时符合空间和语义条件约束的对象，常见查询有 Top-*k*、*k*-NN 等。由于传统的空间数据索引不支持文本数据管理，一般将空间索引与文本索引或位图技术相结合构成混合索引结构，支持同时对空间和文本数据的查询，以缩小搜索范围.

#### **时态数据库**

在过去的 20 年里，时态数据管理一直是数据库的活跃领域之一，研究内容包括数据模型、查询语言、索引结构及高效查询算法，各种查询语言也被提出以支持时态数据查询的形式化描述.Enderle 等人基于常见的时态数据索引之一 ——**Interval-tree** 设计了相应的外存结构以及在关系数据库系统中的实现方法，可以有效支持相交查询和连接查询 [[96](http://www.jos.org.cn/html/2019/1/5646.htm#b96)]; Top-*k* 查询用于返回与查询点 (区间) 相交且权重最大的 *k* 个对象.Dignös 等人将时态数据运算操作、转换原则及查询优化方法集成到关系数据库系统内核中 (PostgreSQL), 以扩展其处理能力 [[97](http://www.jos.org.cn/html/2019/1/5646.htm#b97)], 商用数据库 **Oracle 提供了数据类型 PERIOD 及相关谓词和函数**.

近几年，时态数据库的研究主要集中在高效处理各种连接查询 (例如 overlap join, merge join)、聚类查询 (aggregation) 以及数据划分和排列方法 (partition/splitter, align). 同时，**硬件技术 (例如多核 CPU) 的发展也有助于提高查询效率**。不确定性时态数据将时态数据和不确定性相结合，也有不少相关研究工作，包括数据表示及建模、不确定性时态数据查询等；时态数据集成是根据用户指定优先规则对多源时态数据加以融合.

#### **移动对象数据库**

早期的移动对象数据库研究主要集中在数据模型、索引和查询处理等 [[98](http://www.jos.org.cn/html/2019/1/5646.htm#b98)], 代表性索引结构有 **TB-Tree、SETI、TPR-tree、STRIPES** 等 [[99](http://www.jos.org.cn/html/2019/1/5646.htm#b99)], 这些结构的差异主要体现在时空数据的管理方法 (例如插入原则、时空优先权) 上，**常见的移动对象查询有范围查询、(连续) 最近邻、相似性轨迹、连接查询等**。针对大规模移动对象位置的实时更新，有学者提出了有效的更新策略及监控方法，也有学者对不确定性移动对象进行了研究 [[100](http://www.jos.org.cn/html/2019/1/5646.htm#b100)]. 近年来，面向特定应用的移动对象查询得到了广泛的关注，例如轨迹模式匹配、异常现象分析、基于轨迹的用户行为推荐、轨迹压缩等。由于大规模移动对象数据获取已相对容易，对历史数据分析其结果可为应用提供支撑，例如最优路径推荐、最优出行方式及路线规划、交通流量预测等。除了支持时空查询，系统也需要对用户的位置信息进行有效保护，针对这一问题，有学者开展了基于位置隐私保护的研究.

人的运动除了在自由空间下，更多的时候是在受限空间下，例如道路网 [[101](http://www.jos.org.cn/html/2019/1/5646.htm#b101)]、有障碍空间 [[102](http://www.jos.org.cn/html/2019/1/5646.htm#b102)] 和室内环境。不同环境的主要区别在于移动对象位置表示和距离函数：自由空间的位置通过坐标表示，距离函数基于欧式距离；而受限空间下的位置依赖于底层空间环境，距离函数与最短路径相关，求解过程相对复杂。例如，道路网环境下采用 Map-matching 技术，将 GPS 位置 (经纬度) 映射到道路网从而得到道路网移动对象；在室内环境，移动对象位置获取一般依靠 RFID、WiFi 等技术，位置表示则采用基于符号的表示方法。上述工作均是针对单个空间环境下的移动对象，**也有学者将多个环境的不同位置表示方法相融合，形成统一的位置表示方法，支持人的完整运动轨迹表示以及不同运动方式的移动对象数据管理，例如步行→公交车→步行→室内**.

在大数据背景下，新应用要求数据包含更多的信息以全面理解用户行为，移动对象数据也从传统的时空数据拓展到具有语义信息和行为描述 [[103](http://www.jos.org.cn/html/2019/1/5646.htm#b103), [104](http://www.jos.org.cn/html/2019/1/5646.htm#b104)]. 语义轨迹是将 GPS 数据和时空场景相结合，例如兴趣点或用户行为，给移动对象赋予相关描述 (可通过数据挖掘算法得出并以标签形式存储), 丰富移动对象表示。**基于语义轨迹的常见查询有模式挖掘和匹配 [[103](http://www.jos.org.cn/html/2019/1/5646.htm#b103)]、时空语义关键字查询、top-*k* 查询以及移动用户行为分析** (规律性地访问某些位置、规避和会合等). **基于硬件的技术也被用于大规模轨迹数据查询和分析，例如基于主存的轨迹存储和查询方法、分布式 / 并行轨迹数据处理平台 (基于 Spark 和 Hadoop)、基于 GPU 的交互式时空数据查询等，轨迹数据可视化技术也有相关研究.**

#### **时空数据管理系统**

时空数据管理系统的设计主要有两种思路：一种是**对传统关系数据库管理系统的内核修改或扩展以支持时空数据管理**，包括数据类型、访问方法、查询语言等；另一种则通过**在应用层和传统数据库管理系统层之间构建一层结构，用于时空数据和传统数据的相互转换**，即，在应用层以时空数据处理而在系统存储层还是以传统数据形式来加以处理。**第 1 种方法能够保证效率最优，第 2 种方法则能够在较短时间内达到实际可行的效果**.

并行处理技术在时空数据库领域也得到了快速发展，主要用于大规模数据查询处理 [[105](http://www.jos.org.cn/html/2019/1/5646.htm#b105)]. 在空间数据库方面，SpatialHadoop 和 HadoopGIS 均是基于 Hadoop 的空间数据处理系统，Simba 是基于 Spark 技术的空间数据分析系统 [[106](http://www.jos.org.cn/html/2019/1/5646.htm#b106)], 其对 SparkSQL 进行了扩展，能够有效地支持并发查询。在时态数据库方面，有基于 PostgreSQL 的时态数据查询原型系统和在线实时时态数据分析系统 OceanRT. 在移动对象数据库方面，有针对轨迹数据处理的引擎 Hermes、支持多种轨迹数据挖掘操作及可视化系统 MoveMine、基于内存的分布式系统 SharkDB、DITA[[107](http://www.jos.org.cn/html/2019/1/5646.htm#b107)]、轨迹数据在线分析系统 T-Warehouse、大规模轨迹数据管理和分析平台 UlTraMan[[108](http://www.jos.org.cn/html/2019/1/5646.htm#b108)].SECONDO 是一个开源可扩充性数据库管理系统，可对空间、时态和移动对象数据有效管理且支持并行处理 [[109](http://www.jos.org.cn/html/2019/1/5646.htm#b109)].

### **总结与展望**

时空大数据具有多维度、多类型、变化快等特点，给数据库管理系统提出了新的挑战：一方面，需要提供数据类型和运算操作以支持时空数据查询；另一方面，高效查询处理对数据库性能有较高的要求。迄今，时空数据库的发展趋势包含以下几点.

● **具有语义描述的时空数据管理**，可分为时空数据和流数据两类：前者针对包含**关键字**的时空数据进行查询，后者**针对高频率的流数据进行连续查询**。为增加用户满意度，**交互式和探索式查询**也是进一步研究的方向之一；

● 并行 / 分布式环境下的大规模时空数据管理系统。现有的时空数据库原型系统需要在支持的查询种类和通用性数据表示上进一步提升。同时，随着越来越多的时空数据管理系统被研发，需要在统一标准下对系统的功能及性能进行全面测试和评估 (benchmark). **新型存储设备 (例如，SSD 具有快速随机写等特点) 的发展，将给位置频繁更新的移动对象研究带来新的契机**；

● 具有智能性的时空数据库系统。在人工智能技术快速发展的背景下，如何融入机器学习方法以增加系统的智能性，是新一代时空数据库管理系统研究的内容，即，系统根据当前处理数据及查询的特点自动进行索引结构和相关算法的调整以使性能最优，例如参数配置、数据划分、缓存设置等.